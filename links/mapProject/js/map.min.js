function initMap(){function e(){var e=$(window).width();1080>=e?(map.setZoom(7),map.setCenter(t.center)):e>1080&&(map.setZoom(7),map.setCenter(t.center))}var t={zoom:7,center:new google.maps.LatLng(43.154855,-71.185913),mapTypeControl:!1,disableDefaultUI:!0};infowindow=new google.maps.InfoWindow,$(window).width()<=1080&&(t.zoom=7),($(window).width()<850||$(window).height()<595)&&hideNav(),map=new google.maps.Map(document.getElementById("map-canvas"),t),setMarkers(markers),setAllMap(),$(window).resize(function(){e()})}function setAllMap(){for(var e=0;e<markersArray.length;e++)markersArray[e].setMap(map)}function setMarkerVisibility(){for(var e=0;e<markersArray.length;e++)markersArray[e].boolTest===!0&&markersArray[e].setMap(map)}function streetImage(){streetViewImage=1===i?streetViewUrl+"42.365952,-71.09139&heading="+headingImageView[i]:2===i?streetViewUrl+"44.5698785,-72.6034606&heading="+headingImageView[i]:3===i?"https://static1.squarespace.com/static/501bb93ec4aa651f100e3b0f/t/54fcac81e4b0744cac578162/1425845380792/Photo+Dec+10,+3+51+47+PM.jpg":4===i?streetViewUrl+"43.492565,-70.452947&heading="+headingImageView[i]:5===i?streetViewUrl+"42.520458,-70.890754&heading="+headingImageView[i]:8===i?streetViewUrl+"41.185437,-73.142081&heading="+headingImageView[i]:9===i?streetViewUrl+"42.392126,-71.044136&heading="+headingImageView[i]:15===i?streetViewUrl+"44.083128,-69.56301&heading="+headingImageView[i]:streetViewUrl+markers[i].lat+","+markers[i].lng+"&heading="+headingImageView[i]+"&pitch=1"}function setMarkers(e){for(i=0,len=e.length;i<len;i++){markersArray.push(new google.maps.Marker({position:new google.maps.LatLng(e[i].lat,e[i].lng),zIndex:1,map:map,title:e[i].title,animation:google.maps.Animation.DROP,icon:{url:"img/beerMarker.png",size:new google.maps.Size(26.25,30),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(12.5,40)},shape:{coords:[1,25,-40,-25,1],type:"poly"}})),streetImage();var t,r,a=$(window).width();750>=a?(t=165,r=82.5):a>750&&(t=300,r=150),e[i].contentString='<img src="'+streetViewImage+'" width="'+t+'" height="'+r+'" alt="Street View Image of '+e[i].title+'"><br><hr style="margin-bottom: 5px"><strong>'+e[i].title+"</strong><br><p>"+e[i].streetAddress+"<br>"+e[i].cityAddress+'<br></p><a class="web-links" href="http://'+e[i].url+'" target="_blank">'+e[i].url+"</a><br>",new google.maps.event.addListener(markersArray[i],"click",function(t,i){return function(){retrieveWeather(e[i]);var r=$(window).width();1080>=r?map.setZoom(14):r>1080&&map.setZoom(16),map.setCenter(t.getPosition()),e[i].picBoolTest=!0,infowindow.setContent(e[i].contentString),infowindow.open(map,this),t.setAnimation(google.maps.Animation.BOUNCE)}}(markersArray[i],i))}viewModel.locations().forEach(function(e,t){e.marker=markersArray[t]})}function noNav(){$("#search-nav").animate({height:0},500),setTimeout(function(){$("#search-nav").hide()},500),$("#miniNav").attr("src","img/mapPointer.png"),isNavVisible=!1}function yesNav(){$("#search-nav").show();var e=$("#info-box").height()-50;$(window).height()<500?$("#search-nav").animate({height:e},500):$("#search-nav").animate({height:e-110},500),$("#miniNav").attr("src","img/mapPointer.png"),isNavVisible=!0}function hideNav(){isNavVisible===!0?noNav():yesNav()}function retrieveWeather(e){var t=e.marker.position.lat(),i=e.marker.position.lng(),r="http://api.wunderground.com/api/8b2bf4a9a6f86794/conditions/q/"+t+","+i+".json";$.getJSON(r,function(t){detail=t.current_observation,e.contentString+='<ul class="forecast"><li>Temp: '+detail.temp_f+'° F</li><li><img style="width: 25px" src="'+detail.icon_url+'">  '+detail.icon+"</li></ul>",infowindow.setContent(e.contentString)}).error(function(e){$(".forecast").append('<p style="text-align: center;">Sorry! Weather Underground</p><p style="text-align: center;">Could Not Be Loaded</p>')})}var map,infowindow,markersArray=[],markers=[{title:"Narragansett Brewing Co.",lat:41.876652,lng:-71.388914,streetAddress:"461 Main St",cityAddress:"Pawtucket, RI 02860",url:"http://narragansettbeer.com/",id:"nav0",visible:ko.observable(!0),boolTest:!0},{title:"Cambridge Brewing Co.",lat:42.368136,lng:-71.090214,streetAddress:"1 Kendall Square",cityAddress:"Cambridge, MA 02139",url:"http://cambridgebrewingcompany.com/",id:"nav1",visible:ko.observable(!0),boolTest:!0},{title:"Lost Nation Brewing",lat:44.569963,lng:-72.603064,streetAddress:"B, 87 Old Creamery Rd",cityAddress:"Morristown, VT 05661",url:"http://lostnationbrewing.com/",id:"nav2",visible:ko.observable(!0),boolTest:!0},{title:"Tree House Brewing Co.",lat:42.092983,lng:-72.288632,streetAddress:"160 E Hill Rd",cityAddress:"Monson, MA 01057",url:"http://treehousebrew.com/",id:"nav3",visible:ko.observable(!0),boolTest:!0},{title:"Banded Horn Brewing Co.",lat:43.493005,lng:-70.452222,streetAddress:"13-W, 32 Main St",cityAddress:"Biddeford, ME 04005",url:"http://bandedhorn.com/",id:"nav4",visible:ko.observable(!0),boolTest:!0},{title:"Notch Brewing",lat:42.519902,lng:-70.890867,streetAddress:"283 Derby St",cityAddress:"Salem, MA 01970",url:"http://notchbrewing.com/",id:"nav5",visible:ko.observable(!0),boolTest:!0},{title:"Portsmouth Brewery",lat:43.077912,lng:-70.757491,streetAddress:"38 Market St",cityAddress:"Portsmouth, NH 03801",url:"http://portsmouthbrewery.com/",id:"nav6",visible:ko.observable(!0),boolTest:!0},{title:"Jack’s Abby Brewing",lat:42.280422,lng:-71.41149,streetAddress:"100 Clinton St",cityAddress:"Framingham, MA 01702",url:"http://jacksabby.com/",id:"nav7",visible:ko.observable(!0),boolTest:!0},{title:"Two Roads Brewing Co.",lat:41.185856,lng:-73.14242,streetAddress:"1700 Stratford Ave",cityAddress:"Stratford, CT 06615",url:"https://tworoadsbrewing.com/",id:"nav8",visible:ko.observable(!0),boolTest:!0},{title:"Mystic Brewery",lat:42.391342,lng:-71.044148,streetAddress:"174 Williams St",cityAddress:"Chelsea, MA 02150",url:"http://mystic-brewery.com/",id:"nav9",visible:ko.observable(!0),boolTest:!0},{title:"Idletyme Brewing Co.",lat:44.474068,lng:-72.713915,streetAddress:"1859 Mountain Rd",cityAddress:"Stowe, VT 05672",url:"https://idletymebrewing.com/",id:"nav10",visible:ko.observable(!0),boolTest:!0},{title:"Idle Hands Craft Ales",lat:42.424392,lng:-71.074746,streetAddress:"89 Commercial St",cityAddress:"Malden, MA 02148",url:"http://idlehandscraftales.com/",id:"nav11",visible:ko.observable(!0),boolTest:!0},{title:"White Birch Brewing",lat:43.058419,lng:-71.442011,streetAddress:"1339 Hooksett Rd",cityAddress:"Hooksett, NH 03106",url:"http://whitebirchbrewing.com/",id:"nav12",visible:ko.observable(!0),boolTest:!0},{title:"Abandoned Building Brewery",lat:42.274179,lng:-72.661653,streetAddress:"142 Pleasant St",cityAddress:"Easthampton, MA 01027",url:"https://abandonedbuildingbrewery.com/",id:"nav13",visible:ko.observable(!0),boolTest:!0},{title:"New England Brewing Co.",lat:41.33878,lng:-72.980402,streetAddress:"175 Amity Rd",cityAddress:"Woodbridge, CT 06525",url:"http://newenglandbrewing.com/",id:"nav14",visible:ko.observable(!0),boolTest:!0},{title:"Oxbow Brewing Co.",lat:44.082794,lng:-69.56368,streetAddress:"274 Jones Woods Rd",cityAddress:"Newcastle, ME 04553",url:"http://oxbowbeer.com/",id:"nav15",visible:ko.observable(!0),boolTest:!0},{title:"Maine Beer Co.",lat:43.839841,lng:-70.121731,streetAddress:"525 US-1",cityAddress:"Freeport, ME 04032",url:"http://mainebeercompany.com/",id:"nav16",visible:ko.observable(!0),boolTest:!0},{title:"Hill Farmstead Brewery",lat:44.606276,lng:-72.263635,streetAddress:"403 Hill Rd",cityAddress:"Greensboro Bend, VT 05842",url:"http://hillfarmstead.com/",id:"nav17",visible:ko.observable(!0),boolTest:!0},{title:"Samuel Adams",lat:42.314804,lng:-71.103218,streetAddress:"30 Germania St",cityAddress:"Boston, MA 02130",url:"http://samueladams.com/",id:"nav18",visible:ko.observable(!0),boolTest:!0},{title:"Harpoon Brewery",lat:42.34665,lng:-71.033669,streetAddress:"306 Northern Ave",cityAddress:"Boston, MA 02210",url:"http://Harpoonbrewery.com/",id:"nav19",visible:ko.observable(!0),boolTest:!0}],headingImageView=[290,19,30,null,-10,290,285,95,-32,191,190,293,80,175,54,270,133,20,157,267],streetViewImage,streetViewUrl="https://maps.googleapis.com/maps/api/streetview?size=300x150&location=",viewModel={query:ko.observable(""),doSomething:function(){onChangeHandler()},typeAbove:ko.observable(""),showInfo:function(e){google.maps.event.trigger(e.marker,"click")},availableBreweries:ko.observableArray(markers)};viewModel.locations=ko.observableArray(markers),viewModel.markers=ko.computed(function(){var e=this,t=e.query().toLowerCase();if(""===t){for(var i=0;i<markersArray.length;i++)markersArray[i].setVisible(!0);return markers}return ko.utils.arrayFilter(markers,function(e){var i=e.title.toLowerCase().indexOf(t)>=0;e.boolTest=i;for(var r=0;r<markersArray.length;r++){var a=markersArray[r].title.toLowerCase().indexOf(t)>=0;markersArray[r].setVisible(a)}return i||setMarkerVisibility(),i})},viewModel),ko.applyBindings(viewModel);var isNavVisible=!0;$("#miniNav").click(hideNav),$(window).resize(function(){$(window).width();$(window).width()<750&&isNavVisible===!0?noNav():$(window).height()<495&&isNavVisible===!0&&noNav(),$(window).width()>=750&&isNavVisible===!1?$(window).height()>495&&yesNav():$(window).height()>=495&&isNavVisible===!1&&$(window).width()>750&&yesNav()}),window.onerror=function(){$("#failure").css("display","block")};