function initMap(){function e(){var e=$(window).width();1080>=e?(map.setZoom(7),map.setCenter(i.center)):e>1080&&(map.setZoom(7),map.setCenter(i.center))}function t(e,t){for(var i=[],o=document.getElementById("waypoints"),a=0;a<o.length;a++)o.options[a].selected&&i.push({location:o[a].value,stopover:!0}),""===addEnd.val()&&addEnd.val(addBegin.val());e.route({origin:addBegin.val(),destination:addEnd.val(),waypoints:i,optimizeWaypoints:!0,travelMode:"DRIVING"},function(e,i){if("OK"===i){$("#failure").css("display","none"),t.setDirections(e);e.routes[0]}else $("#failure").css("display","block")})}var i={zoom:7,center:new google.maps.LatLng(43.154855,-71.185913),mapTypeControl:!1,disableDefaultUI:!0};$(window).width()<=1080&&(i.zoom=7),($(window).width()<850||$(window).height()<595)&&hideNav();var o=new google.maps.DirectionsService,a=new google.maps.DirectionsRenderer;map=new google.maps.Map(document.getElementById("map-canvas"),i),setMarkers(markers),setAllMap(),$(window).resize(function(){e()}),a.setMap(map);var s=function(){t(o,a)};addBegin.change(s),addEnd.change(s),$("#submit").click(s)}function setAllMap(){for(var e=0;e<markers.length;e++)markers[e].boolTest===!0?markers[e].holdMarker.setMap(map):markers[e].holdMarker.setMap(null)}function streetImage(){streetViewImage=1===i?streetViewUrl+"42.365952,-71.09139&heading="+headingImageView[i]:2===i?streetViewUrl+"44.5698785,-72.6034606&heading="+headingImageView[i]:3===i?"https://static1.squarespace.com/static/501bb93ec4aa651f100e3b0f/t/54fcac81e4b0744cac578162/1425845380792/Photo+Dec+10,+3+51+47+PM.jpg":4===i?streetViewUrl+"43.492565,-70.452947&heading="+headingImageView[i]:5===i?streetViewUrl+"42.520458,-70.890754&heading="+headingImageView[i]:8===i?streetViewUrl+"41.185437,-73.142081&heading="+headingImageView[i]:9===i?streetViewUrl+"42.392126,-71.044136&heading="+headingImageView[i]:15===i?streetViewUrl+"44.083128,-69.56301&heading="+headingImageView[i]:streetViewUrl+markers[i].lat+","+markers[i].lng+"&heading="+headingImageView[i]+"&pitch=1"}function setMarkers(e){for(i=0;i<e.length;i++){e[i].holdMarker=new google.maps.Marker({position:new google.maps.LatLng(e[i].lat,e[i].lng),zIndex:1,map:map,title:e[i].title,animation:google.maps.Animation.DROP,icon:{url:"img/beerMarker.png",size:new google.maps.Size(26.25,30),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(12.5,40)},shape:{coords:[1,25,-40,-25,1],type:"poly"}}),streetImage(),e[i].contentString='<img src="'+streetViewImage+'" width="300" height="150" alt="Street View Image of '+e[i].title+'"><br><hr style="margin-bottom: 5px"><strong>'+e[i].title+"</strong><br><p>"+e[i].streetAddress+"<br>"+e[i].cityAddress+'<br></p><a class="web-links" href="http://'+e[i].url+'" target="_blank">'+e[i].url+"</a>";var t=new google.maps.InfoWindow({content:markers[i].contentString});new google.maps.event.addListener(e[i].holdMarker,"click",function(i,o){return function(){t.setContent(e[o].contentString),t.open(map,this);var a=$(window).width();1080>=a?map.setZoom(14):a>1080&&map.setZoom(16),map.setCenter(i.getPosition()),e[o].picBoolTest=!0,null!==i.getAnimation()?i.setAnimation(null):i.setAnimation(google.maps.Animation.BOUNCE)}}(e[i].holdMarker,i));var o=$("#nav"+i);o.click(function(i,o){return function(){t.setContent(e[o].contentString),t.open(map,i),map.setZoom(17),map.setCenter(i.getPosition()),e[o].picBoolTest=!0}}(e[i].holdMarker,i))}}function noNav(){$("#search-nav").animate({height:0},500),setTimeout(function(){$("#search-nav").hide()},500),$("#miniNav").attr("src","img/mapPointer.png"),isNavVisible=!1}function yesNav(){$("#search-nav").show();var e=$("#directions").height()+25;$(window).height()<500?$("#search-nav").animate({height:e},500):$("#search-nav").animate({height:e},500),$("#miniNav").attr("src","img/mapPointer.png"),isNavVisible=!0}function hideNav(){isNavVisible===!0?noNav():yesNav()}var map,markersArray=[],markers=[{title:"Narragansett Brewing Co.",lat:41.876652,lng:-71.388914,streetAddress:"461 Main St",cityAddress:"Pawtucket, RI 02860",url:"http://www.narragansettbeer.com/",id:"nav0",visible:ko.observable(!0),boolTest:!0},{title:"Cambridge Brewing Co.",lat:42.368136,lng:-71.090214,streetAddress:"1 Kendall Square",cityAddress:"Cambridge, MA 02139",url:"http://www.cambridgebrewingcompany.com/",id:"nav1",visible:ko.observable(!0),boolTest:!0},{title:"Lost Nation Brewing",lat:44.569963,lng:-72.603064,streetAddress:"B, 87 Old Creamery Rd",cityAddress:"Morristown, VT 05661",url:"http://lostnationbrewing.com/",id:"nav2",visible:ko.observable(!0),boolTest:!0},{title:"Tree House Brewing Co.",lat:42.092983,lng:-72.288632,streetAddress:"160 E Hill Rd",cityAddress:"Monson, MA 01057",url:"http://treehousebrew.com/",id:"nav3",visible:ko.observable(!0),boolTest:!0},{title:"Banded Horn Brewing Co.",lat:43.493005,lng:-70.452222,streetAddress:"13-W, 32 Main St",cityAddress:"Biddeford, ME 04005",url:"http://www.bandedhorn.com/",id:"nav4",visible:ko.observable(!0),boolTest:!0},{title:"Notch Brewing",lat:42.519902,lng:-70.890867,streetAddress:"283 Derby St",cityAddress:"Salem, MA 01970",url:"http://www.notchbrewing.com/",id:"nav5",visible:ko.observable(!0),boolTest:!0},{title:"Portsmouth Brewery",lat:43.077912,lng:-70.757491,streetAddress:"38 Market St",cityAddress:"Portsmouth, NH 03801",url:"http://portsmouthbrewery.com/",id:"nav6",visible:ko.observable(!0),boolTest:!0},{title:"Jackâ€™s Abby Brewing",lat:42.280422,lng:-71.41149,streetAddress:"100 Clinton St",cityAddress:"Framingham, MA 01702",url:"http://jacksabby.com/",id:"nav7",visible:ko.observable(!0),boolTest:!0},{title:"Two Roads Brewing Co.",lat:41.185856,lng:-73.14242,streetAddress:"1700 Stratford Ave",cityAddress:"Stratford, CT 06615",url:"https://tworoadsbrewing.com/",id:"nav8",visible:ko.observable(!0),boolTest:!0},{title:"Mystic Brewery",lat:42.391342,lng:-71.044148,streetAddress:"174 Williams St",cityAddress:"Chelsea, MA 02150",url:"http://www.mystic-brewery.com/",id:"nav9",visible:ko.observable(!0),boolTest:!0},{title:"Idletyme Brewing Co.",lat:44.474068,lng:-72.713915,streetAddress:"1859 Mountain Rd",cityAddress:"Stowe, VT 05672",url:"https://idletymebrewing.com/",id:"nav10",visible:ko.observable(!0),boolTest:!0},{title:"Idle Hands Craft Ales",lat:42.424392,lng:-71.074746,streetAddress:"89 Commercial St",cityAddress:"Malden, MA 02148",url:"http://www.idlehandscraftales.com/",id:"nav11",visible:ko.observable(!0),boolTest:!0},{title:"White Birch Brewing",lat:43.058419,lng:-71.442011,streetAddress:"1339 Hooksett Rd",cityAddress:"Hooksett, NH 03106",url:"http://www.whitebirchbrewing.com/",id:"nav12",visible:ko.observable(!0),boolTest:!0},{title:"Abandoned Building Brewery",lat:42.274179,lng:-72.661653,streetAddress:"142 Pleasant St",cityAddress:"Easthampton, MA 01027",url:"https://www.abandonedbuildingbrewery.com/",id:"nav13",visible:ko.observable(!0),boolTest:!0},{title:"New England Brewing Co.",lat:41.33878,lng:-72.980402,streetAddress:"175 Amity Rd",cityAddress:"Woodbridge, CT 06525",url:"http://newenglandbrewing.com/",id:"nav14",visible:ko.observable(!0),boolTest:!0},{title:"Oxbow Brewing Co.",lat:44.082794,lng:-69.56368,streetAddress:"274 Jones Woods Rd",cityAddress:"Newcastle, ME 04553",url:"http://oxbowbeer.com/",id:"nav15",visible:ko.observable(!0),boolTest:!0},{title:"Maine Beer Co.",lat:43.839841,lng:-70.121731,streetAddress:"525 US-1",cityAddress:"Freeport, ME 04032",url:"http://www.mainebeercompany.com/",id:"nav16",visible:ko.observable(!0),boolTest:!0},{title:"Hill Farmstead Brewery",lat:44.606276,lng:-72.263635,streetAddress:"403 Hill Rd",cityAddress:"Greensboro Bend, VT 05842",url:"http://hillfarmstead.com/",id:"nav17",visible:ko.observable(!0),boolTest:!0},{title:"Samuel Adams",lat:42.314804,lng:-71.103218,streetAddress:"30 Germania St",cityAddress:"Boston, MA 02130",url:"http://samueladams.com/",id:"nav18",visible:ko.observable(!0),boolTest:!0},{title:"Harpoon Brewery",lat:42.34665,lng:-71.033669,streetAddress:"306 Northern Ave",cityAddress:"Boston, MA 02210",url:"http://Harpoonbrewery.com/",id:"nav19",visible:ko.observable(!0),boolTest:!0}],headingImageView=[290,19,30,null,-10,290,285,95,-32,191,190,293,80,175,54,270,133,20,157,267],streetViewImage,streetViewUrl="https://maps.googleapis.com/maps/api/streetview?size=300x150&location=",viewModel={query:ko.observable("")};viewModel.markers=ko.dependentObservable(function(){var e=this,t=e.query().toLowerCase();return ko.utils.arrayFilter(markers,function(e){return e.title.toLowerCase().indexOf(t)>=0?(e.boolTest=!0,e.visible(!0)):(e.boolTest=!1,setAllMap(),e.visible(!1))})},viewModel),ko.applyBindings(viewModel),$("#searchBox").keyup(function(){setAllMap()});var isNavVisible=!0;$("#miniNav").click(hideNav),$(window).resize(function(){$(window).width();$(window).width()<750&&isNavVisible===!0?noNav():$(window).height()<495&&isNavVisible===!0&&noNav(),$(window).width()>=750&&isNavVisible===!1?$(window).height()>495&&yesNav():$(window).height()>=495&&isNavVisible===!1&&$(window).width()>750&&yesNav()});var directBox=$("#directions"),directBoxActive=!1,directButton=$("#directButton");directButton.click(function(){directBoxActive===!1?($("#scroller").css("display","none"),directButton.html("Navigation"),$("#searchBox").hide(),500,$("#directions").css("display","block"),directBoxActive=!0,$(window).width()<670&&"landscape-primary"===screen.orientation.type?(directButton.animate({width:"95%"},500),$("#waypoints").attr("size","8")):$(window).width()<670&&"portrait-primary"===screen.orientation.type?(directButton.animate({width:"95%"},500),$("#waypoints").attr("size","5")):directButton.animate({width:"100%"},500)):($("#scroller").css("display","block"),$("#searchBox").css("display","block"),$("#directions").css("display","none"),directButton.html("Directions"),directBoxActive=!1,$(window).width()<580?(directButton.css("width","37%"),directButton.animate({width:"35%"},500)):(directButton.css("width","41%"),directButton.animate({width:"35%"},500)))});var addBegin=$("#addBegin"),addEnd=$("#addEnd");addBegin.keyup(function(){addEnd.attr("placeholder",addBegin.val())});var last_valid_selection=null;$("#waypoints").change(function(e){$(this).val().length>6?(alert("Slow down there killer! You may only choose 6 at a time!"),$(this).val(last_valid_selection)):last_valid_selection=$(this).val()}),window.addEventListener("orientationchange",function(){var e=screen.orientation||screen.mozOrientation||screen.msOrientation;"landscape-primary"===e.type?(console.log("That looks good."),$("#waypoints").attr("size","8")):"landscape-secondary"===e.type?(console.log("Mmmh... the screen is upside down!"),$("#waypoints").attr("size","8")):("portrait-secondary"===e.type||"portrait-primary"===e.type)&&(console.log("Mmmh... you should rotate your device to landscape"),$("#waypoints").attr("size","5"))});